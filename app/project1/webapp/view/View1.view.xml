<mvc:View controllerName="project1.controller.View1"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.f"
    xmlns:card="sap.f.cards"
    displayBlock="true">
    
    <Page id="reconciliationPage" title="Financial Reconciliation System" showNavButton="false">
                
        <content>
            <IconTabBar id="mainTabBar" class="sapUiResponsiveContentPadding">
                <items>
                    <!-- DASHBOARD TAB -->
                    <IconTabFilter id="dashboardTab" icon="sap-icon://business-objects-experience" text="Dashboard" key="dashboard">
                        <l:VerticalLayout id="_IDGenVerticalLayout" width="100%">
                            <!-- KPI Cards Grid -->
                            <l:Grid id="_IDGenGrid" defaultSpan="XL3 L6 M6 S12" class="sapUiSmallMarginBottom">
                                <!-- Card 1: Total (Matched + Discrepancies) title="{/totalCount}" -->
                                <f:Card id="_IDGenCard" class="sapUiSmallMargin">
                                    <f:header>
                                        <card:Header id="_IDGenHeader"
                                            title="1857"  
                                            subtitle="Total Reconciliation of POS Sales and Merchant Settlement"
                                            iconSrc="sap-icon://sum"
                                            iconDisplayShape="Circle"/>
                                    </f:header>
                                    <f:content>
                                        <VBox id="_IDGenVBox" class="sapUiSmallMargin">
                                            <ObjectStatus id="_IDGenObjectStatus" text="+12% from yesterday" state="Success"/>
                                        </VBox>
                                    </f:content>
                                </f:Card>

                                <!-- Card 2: Matched Today -->
                                <f:Card id="_IDGenCard1" class="sapUiSmallMargin">
                                    <f:header>
                                        <card:Header id="_IDGenHeader1"
                                            title="1,834"
                                            subtitle="Matched Today"
                                            iconSrc="sap-icon://accept"
                                            iconDisplayShape="Circle"/>
                                    </f:header>
                                    <f:content>
                                        <VBox id="_IDGenVBox1" class="sapUiSmallMargin">
                                            <ObjectStatus id="_IDGenObjectStatus1" text="+8% vs average" state="Success"/>
                                        </VBox>
                                    </f:content>
                                </f:Card>

                                <!-- Card 3: Discrepancies -->
                                <f:Card id="_IDGenCard2" class="sapUiSmallMargin">
                                    <f:header>
                                        <card:Header id="_IDGenHeader2"
                                            title="23"
                                            subtitle="Discrepancies"
                                            iconSrc="sap-icon://alert"
                                            iconDisplayShape="Circle"/>
                                    </f:header>
                                    <f:content>
                                        <VBox id="_IDGenVBox2" class="sapUiSmallMargin">
                                            <ObjectStatus id="_IDGenObjectStatus2" text="-5% from yesterday" state="Success"/>
                                        </VBox>
                                    </f:content>
                                </f:Card>

                                <!-- Card 4: Total Amount Matched + Unmatched -->

                                <f:Card id="_IDGenCard3" class="sapUiSmallMargin">

                                    <f:header>

                                        <card:Header id="_IDGenHeader3"

                                            title="2.4M"

                                            subtitle="Total Reconciliation Amount of POS Sales and Merchant Settlement"

                                            iconSrc="sap-icon://money-bills"

                                            iconDisplayShape="Circle"/>

                                    </f:header>

                                    <f:content>

                                        <VBox id="_IDGenVBox3" class="sapUiSmallMargin">

                                            <ObjectStatus id="_IDGenObjectStatus3" text="+15% from average" state="Success"/>

                                        </VBox>

                                    </f:content>

                                </f:Card>

                                 <!-- Card 5: Matched Amount -->

                                <f:Card id="_IDGenCard4" class="sapUiSmallMargin">

                                    <f:header>

                                        <card:Header id="_IDGenHeader4"

                                            title="2.35M"

                                            subtitle="Total Matched Reconciliation Amount of POS Sales and Merchant Settlement"

                                            iconSrc="sap-icon://sys-enter-2"

                                            iconDisplayShape="Circle"/>

                                    </f:header>

                                    <f:content>

                                        <VBox id="_IDGenVBox8" class="sapUiSmallMargin">

                                            <ObjectStatus id="_IDGenObjectStatus8" text="97.9% of total" state="Success"/>

                                        </VBox>

                                    </f:content>

                                </f:Card>



                                <!-- Card 6: Unmatched Amount -->

                                <f:Card id="_IDGenCard5" class="sapUiSmallMargin">

                                    <f:header>

                                        <card:Header id="_IDGenHeader5"

                                            title="50K"

                                            subtitle="Total Unmatched Reconciliation Amount of POS Sales and Merchant Settlement"

                                            iconSrc="sap-icon://sys-cancel-2"

                                            iconDisplayShape="Circle"/>

                                    </f:header>

                                    <f:content>

                                        <VBox id="_IDGenVBox9" class="sapUiSmallMargin">

                                            <ObjectStatus id="_IDGenObjectStatus9" text="2.1% of total" state="Warning"/>

                                        </VBox>

                                    </f:content>

                                </f:Card>
                            </l:Grid>

                            <!-- Recent Activity -->
                            <Panel id="_IDGenPanel1" headerText="Recent Activity" class="sapUiResponsiveMargin">
                                <List id="_IDGenList" items="{/recentActivity}">
                                    <StandardListItem id="_IDGenStandardListItem"
                                        title="{action}"
                                        description="{timestamp}"
                                        icon="{icon}"/>
                                </List>
                            </Panel>
                        </l:VerticalLayout>
                    </IconTabFilter>

                    <!-- RECONCILIATION TAB -->
                    <IconTabFilter id="reconTab" icon="sap-icon://receipt" text="Reconciliation" key="recon">
                        <Panel id="_IDGenPanel2" headerText="Reconciliation">
                            <headerToolbar>
                                <OverflowToolbar id="_IDGenOverflowToolbar">
                                    <Title id="_IDGenTitle" text="Reconciliation"/>
                                    <ToolbarSpacer id="_IDGenToolbarSpacer1"/>
                                    <SearchField id="_IDGenSearchField" width="300px" search="onSearchPOS"/>
                                    <Button id="_IDGenButton4" icon="sap-icon://filter" press="onOpenFilter"/>
                                    <Button id="_IDGenButton5" text="Auto-Match" type="Emphasized" icon="sap-icon://play" press="onAutoMatch"/>
                                </OverflowToolbar>
                            </headerToolbar>
                            <content>
                                <Table
                                    id="posTable"
                                    items="{/transactions}"
                                    mode="MultiSelect"
                                    growing="true"
                                    growingThreshold="50">
                                    <columns>
                                        <Column id="_IDGenColumn" width="12em">
                                            <Text id="_IDGenText2" text="Transaction ID"/>
                                        </Column>
                                        <Column id="_IDGenColumn1" width="8em">
                                            <Text id="_IDGenText3" text="Date"/>
                                        </Column>
                                        <Column id="_IDGenColumn2" minScreenWidth="Tablet" demandPopin="true">
                                            <Text id="_IDGenText4" text="Product"/>
                                        </Column>
                                        <Column id="_IDGenColumn3" hAlign="End" minScreenWidth="Tablet" demandPopin="true">
                                            <Text id="_IDGenText5" text="Net Amount"/>
                                        </Column>
                                        <Column id="_IDGenColumn4" hAlign="End">
                                            <Text id="_IDGenText6" text="Settlement"/>
                                        </Column>
                                        <Column id="_IDGenColumn5" hAlign="End">
                                            <Text id="_IDGenText7" text="Variance"/>
                                        </Column>
                                        <Column id="_IDGenColumn6" hAlign="Center" width="8em">
                                            <Text id="_IDGenText8" text="Status"/>
                                        </Column>
                                        <Column id="_IDGenColumn7" hAlign="Center" width="8em">
                                            <Text id="_IDGenText9" text="Action"/>
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem id="_IDGenColumnListItem" type="Active" press="onTransactionPress">
                                            <cells>
                                                <ObjectIdentifier id="_IDGenObjectIdentifier" title="{transactionId}"/>
                                                <Text id="_IDGenText10" text="{date}"/>
                                                <VBox id="_IDGenVBox4">
                                                    <Text id="_IDGenText11" text="{product}"/>
                                                    <Text id="_IDGenText12" text="{sku}" class="sapUiTinyText"/>
                                                </VBox>
                                                <ObjectNumber id="_IDGenObjectNumber"
                                                    number="{netAmount}"
                                                    unit=""/>
                                                <ObjectNumber id="_IDGenObjectNumber1"
                                                    number="{settlement}"
                                                    unit=""/>
                                                <ObjectNumber id="_IDGenObjectNumber2"
                                                    number="{variance}"
                                                    unit=""
                                                    state="{= ${variance} > 50 ? 'Error' : ${variance} > 0 ? 'Warning' : 'Success' }"/>
                                                <ObjectStatus id="_IDGenObjectStatus4"
                                                    text="{status}"
                                                    state="{= ${status} === 'Matched' ? 'Success' : ${status} === 'Pending' ? 'Warning' : 'Error' }"/>
                                                <Button id="_IDGenButton6" text="Review" type="Emphasized" press="onReviewTransaction"/>
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </content>
                        </Panel>
                    </IconTabFilter>

                     <!-- RULES ENGINE TAB -->
                    <IconTabFilter id="rulesTab" icon="sap-icon://settings" text="Rules Engine   " key="rules">
                        <Panel id="_IDGenPanel6" headerText="Auto-Match Rules Configuration">
                            <headerToolbar>
                                <OverflowToolbar id="_IDGenOverflowToolbar2">
                                    <Title id="_IDGenTitle2" text="Auto-Match Rules Configuration"/>
                                    <ToolbarSpacer id="_IDGenToolbarSpacer4"/>
                                    <Button id="_IDGenButton12" text="Add New Rule" icon="sap-icon://add" type="Emphasized" press="onAddRule"/>
                                    <Button id="_IDGenButton13" text="Test Selected Rules" icon="sap-icon://play" press="onTestRules" enabled="{= ${/selectedRulesCount} > 0 }"/>
                                    <Button id="_IDGenButton14" text="Delete Selected" icon="sap-icon://delete" type="Reject" press="onDeleteSelectedRules" enabled="{= ${/selectedRulesCount} > 0 }"/>
                                </OverflowToolbar>
                            </headerToolbar>
                            <content>
                                <Table 
                                    id="rulesTable" 
                                    items="{/rules}"
                                    mode="MultiSelect"
                                    selectionChange="onRuleSelectionChange">
                                    <columns>
                                        <Column id="_IDGenColumn16" width="3em">
                                            <Text id="_IDGenText25" text=""/>
                                        </Column>
                                        <Column id="_IDGenColumn17">
                                            <Text id="_IDGenText26" text="Rule Name"/>
                                        </Column>
                                        <Column id="_IDGenColumn18">
                                            <Text id="_IDGenText27" text="Description"/>
                                        </Column>
                                        <Column id="_IDGenColumn19">
                                            <Text id="_IDGenText28" text="Conditions"/>
                                        </Column>
                                        <Column id="_IDGenColumn20" hAlign="Center" width="8em">
                                            <Text id="_IDGenText29" text="Status"/>
                                        </Column>
                                        <Column id="_IDGenColumn21" hAlign="Center" width="10em">
                                            <Text id="_IDGenText30" text="Actions"/>
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem id="_IDGenColumnListItem3" type="Active">
                                            <cells>
                                                <CheckBox id="_IDGenCheckBox" selected="{selected}"/>
                                                <VBox id="_IDGenVBox5">
                                                    <Title id="_IDGenTitle3" text="{ruleName}" level="H5"/>
                                                </VBox>
                                                <Text id="_IDGenText31" text="{description}"/>
                                                <Text id="_IDGenText32" text="{conditions}"/>
                                                <Switch id="_IDGenSwitch" 
                                                    state="{enabled}" 
                                                    customTextOn="Active" 
                                                    customTextOff="Inactive"
                                                    change="onRuleToggle"/>
                                                <HBox id="_IDGenHBox">
                                                    <Button id="_IDGenButton15" icon="sap-icon://edit" type="Transparent" press="onEditRule" tooltip="Edit Rule"/>
                                                    <Button id="_IDGenButton16" icon="sap-icon://delete" type="Transparent" press="onDeleteRule" tooltip="Delete Rule"/>
                                                    <Button id="_IDGenButton17" icon="sap-icon://play" type="Transparent" press="onTestSingleRule" tooltip="Test This Rule"/>
                                                </HBox>
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </content>
                        </Panel>
                    </IconTabFilter>
                </items>
            </IconTabBar>
        </content>

        <footer>
            <OverflowToolbar id="_IDGenOverflowToolbar3">
                <ToolbarSpacer id="_IDGenToolbarSpacer5"/>
                <Text id="_IDGenText33" text="Last sync: 2 mins ago"/>
                <Button id="_IDGenButton18" icon="sap-icon://refresh" press="onRefresh"/>
            </OverflowToolbar>
        </footer>
    </Page>
</mvc:View>